version: "3.9"
services:

  mealie:
    container_name: aesordur-mealie
    image: hkotel/mealie:latest
    environment:
      PUID: ${PUID:-1000}
      PGID: ${PGID:-1000}
      TZ: ${TZ:-America/Los_Angeles}
      RECIPE_PUBLIC: "TRUE"
      RECIPE_SHOW_NUTRITION: "TRUE"
      RECIPE_SHOW_ASSETS: "TRUE"
      RECIPE_LANDSCAPE_VIEW: "TRUE"
      RECIPE_DISABLE_COMMENTS: "FALSE"
      RECIPE_DISABLE_AMOUNT: "FALSE"
      WORKERS_PER_CORE: 3
      TOKEN_TIME: 4383
    ports:
      - ${AESORDUR_MEALIE_PORT:-80}:80
    restart: always
    volumes:
      - ${AESORDUR_MEALIE_PATH:-./mealie}:/app/data
    deploy:
      placement:
        constraints: [node.labels.aesordur == true]

  mealie-beta:
    container_name: aesordur-mealie-beta
    image: hkotel/mealie:omni-nightly
    environment:
      PUID: ${PUID:-1000}
      PGID: ${PGID:-1000}
      TZ: ${TZ:-America/Los_Angeles}
      RECIPE_PUBLIC: "TRUE"
      RECIPE_SHOW_NUTRITION: "TRUE"
      RECIPE_SHOW_ASSETS: "TRUE"
      RECIPE_LANDSCAPE_VIEW: "TRUE"
      RECIPE_DISABLE_COMMENTS: "FALSE"
      RECIPE_DISABLE_AMOUNT: "FALSE"
      WORKERS_PER_CORE: 3
      TOKEN_TIME: 4383
    ports:
      - ${AESORDUR_MEALIE_BETA_PORT:-80}:80
    restart: always
    volumes:
      - ${AESORDUR_MEALIE_BETA_PATH:-./mealie-beta}:/app/data
    deploy:
      placement:
        constraints: [node.labels.aesordur == true]
